//----------------------------------------------------------------------------//
//-----------------------RPM INDICATOR 2021-----------------------------------//
//----------------------------------------------------------------------------//
//---------------------TIMER AND COUNTER DRIVER-------------------------------//
//----------------------------------------------------------------------------//

sbit LED01 = P0^0;

volatile unsigned long TempMain = 0;
unsigned int Tcount;

void Counter01();

//----------------------------------------------------------------------------//
//-------------------------TIMER 0 INTERRUPT----------------------------------//
//----------------------------------------------------------------------------//

void Timer0_ISR(void) interrupt 1 //timer0
{
	Tcount++;
	if(Tcount==14)
	{
		TF0 = 0;	TR0 = 0;		//CLEAR OVERFLOW FLAG; STOP TIMER			
		LED01 = ~LED01;				//TOGGLE PIN
		TempMain = TH1<<8;		//SHIFT TH1  
		TempMain |= TL1;			//SHIFT TL1
		TL1 = 0; TH1 = 0;			//CLEAR TL1 AND TL0
		Tcount = 0;						//CLEAR COUNT
		TR0 = 1;							//START TIMER 
	}	
}
//----------------------------------------------------------------------------//
//-------------------------COUNTER ROUTINE------------------------------------//
//----------------------------------------------------------------------------//
void Counter01()
{
	TMOD |= 0x50;						//TMOD_T1COUNTER |	TMOD_T116BIT
	TR1		= 0x01;						//START COUNTER
}

//----------------------------------------------------------------------------//
//------------------------TIMER 0 ROUTINE-------------------------------------//
//----------------------------------------------------------------------------//
void Timer00()
{
	TMOD |= 0x01;						//TMOD_T0TIMER   |	TMOD_T016BIT
	TH0 	= 0x00;						//SET TH0 = 0
	TL0		= 0x00;						//SET TL0 = 0
	IEN0 	= 0x82;						//SET TIMER INTERRUPT
	TR0 	= 1;							//START TIMER
}


//-----------------------------------------------------------------------------
//                            END OF PROGRAM
//-----------------------------------------------------------------------------
